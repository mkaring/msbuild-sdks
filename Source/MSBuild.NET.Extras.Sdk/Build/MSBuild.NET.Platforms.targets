<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<PropertyGroup>
		<MSBuildAllProjects>$(MSBuildAllProjects);$(MSBuildThisFileFullPath)</MSBuildAllProjects>
	</PropertyGroup>

	<PropertyGroup>
		<_SdkPlatformName>$(TargetFrameworkIdentifier)</_SdkPlatformName>
		<_SdkPlatformName Condition="'$(TargetFrameworkIdentifier)' == '.NETCore' OR '$(TargetFrameworkIdentifier)' == 'WindowsPhoneApp'">Windows</_SdkPlatformName>
		<_SdkPlatformName Condition="'$(TargetFrameworkIdentifier)' == '.NETPortable'">Portable</_SdkPlatformName>
		<_SdkPlatformName Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework'">Desktop</_SdkPlatformName>

		<_SdkPlatformTargets>$(MSBuildThisFileDirectory)Platforms\$(_SdkPlatformName).targets</_SdkPlatformTargets>
		<_SdkLanguageTargets>$(MSBuildThisFileDirectory)LanguageTargets\$(_SdkPlatformName).targets</_SdkLanguageTargets>
		<LanguageTargets Condition="Exists('$(_SdkLanguageTargets)')">$(_SdkLanguageTargets)</LanguageTargets>
	</PropertyGroup>

	<Import Project="$(_SdkPlatformTargets)" Condition="Exists('$(_SdkPlatformTargets)')"/>

	<ItemGroup Condition="'$(DisableImplicitFrameworkReferences)' != 'true'">
		<!-- Set Pack=false on implicit references so they don't get added to NuGet packages as framework assemblies -->
		<_SdkImplicitReference Update="@(_SdkImplicitReference)" Pack="false" />

		<!--
			Don't duplicate any references that are explicit in the project file. This means that if you do want to include a framework assembly in your
			NuGet package, you can just add the Reference to your project file.
		-->
		<_SdkImplicitReference Remove="@(Reference)" />

		<!-- Add the implicit references to @(Reference) -->
		<Reference Include="@(_SdkImplicitReference)" />
	</ItemGroup>

	<PropertyGroup>
		<!-- Add conditional compilation symbols for the target framework (for example NET461, NETSTANDARD2_0, NETCOREAPP1_0) -->
		<ImplicitFrameworkDefine Condition="'$(DisableImplicitFrameworkDefines)' != 'true'">$(TargetFramework.Replace('.','_').ToUpperInvariant())</ImplicitFrameworkDefine>
	</PropertyGroup>

	<Target Name="IncludeWindowsLibraryLayoutItems"
			Condition="'$(GenerateLibraryLayout)' == 'true' AND '$(SDKIdentifier)' == 'Windows'"
			DependsOnTargets="PrepareLibraryLayout">
		<ItemGroup>
			<TfmSpecificPackageFile Include="@(_LayoutFile)" PackagePath="lib\$(TargetFramework)\%(_LayoutFile.TargetPath)"/>
		</ItemGroup>
	</Target>

	<!-- Handle Library Layout in NuGet packages -->
	<PropertyGroup>
		<TargetsForTfmSpecificContentInPackage Condition="'$(SkipWindowsLibraryLayout)' != 'true'">$(TargetsForTfmSpecificContentInPackage);IncludeWindowsLibraryLayoutItems</TargetsForTfmSpecificContentInPackage>
	</PropertyGroup>

</Project>